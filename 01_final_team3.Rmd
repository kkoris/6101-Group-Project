---
title: "01_final"
author: "Team3"
date: "`r Sys.Date()`"
output: 
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r init, include=FALSE}
# some of common options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
library(ezids)
# knitr::opts_chunk$set(warning = F, results = "markup", message = F)
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3) 
# options(scipen=9, digits = 3) 
# ‘scipen’: integer. A penalty to be applied when deciding to print numeric values in fixed or exponential notation.  Positive values bias towards fixed and negative towards scientific notation: fixed notation will be preferred unless it is more than ‘scipen’ digits wider.
# use scipen=999 to prevent scientific notation at all times
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

# HW Assignment - Estimation 
The variables in the dataset are:  
Province,	State, Tests,	Days Since 1st Case,	Total cases,	Deaths,	Population, Hispanic,	Non-Hispanic, Female,	Population Density,Air Quality,Mental Health Provider Ratio,	Smokers,Flu Vaccinated

### Import data

```{r import,results='markup'}
Counties_Dataset <- read.csv("Counties Dataset.csv")

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

### Data cleaning
###Removing characters from data frame

```{r, results='markup'}
new_Coundf<-Counties_Dataset[, !sapply(Counties_Dataset, is.character)]

```

###Dropping some columns

```{r, results='markup'}

new_df <- new_Coundf[ , -c(1,2,6,7,19,22,23,24,26,27,29,30,31,32,33,34,41,45,46,48,49) ]

new_df1<-new_df[, -c(16,20,21,22,23,27,28,31,32,33,34,35 )]

new_clean<-new_df1[, -c(10,11,12)]

```


#### Changing Column names

```{r, results='markup'}
colnames(new_clean)<- c("Totalcases","Deaths","Population", "Blacks","Natives","Asians","Hispanics","White","PDSqmile","HDSqmile","ColEduc","Socialize","HseCrowded","Diabetic","PoorHlth","Menunhlthdays","Smokers","Fluvax","RespDisease")


```

#####Removing NAs from the data frame

```{r, results='markup'}
clean<-clean[, -c(20)]
clean<- na.omit(new_clean) 

```

####Creating a new Y variable

```{r, results='markup'}
clean$Totcaspopn<-clean$Totalcases/clean$Population

```

####Creating a Correlation Matrix



```{r, results='markup'}
#install.packages("Hmisc")
library(Hmisc)

corClean<-cor(as.matrix(clean))

```

####Correlation Matrix

```{r, results='markup'}
xkabledply(corClean)

```


```{r, results='markup'}
#install.packages("corrplot")
library(corrplot)
corrplot(corClean)

```



Testing for normality

```{r, results='markup'}
#install.packages("ggpubr")
library("ggpubr")
ggdensity(clean$Totcaspopn, 
          main = "Density plot of Total cases per Population",
          xlab = "Total cases")

ggdensity(clean$Population, main = "Density plot of Population",
          xlab = "Total cases")

```

###QQ Plot

```{r, results='markup'}
qqplot(clean$Totcaspopn, clean$Population, main = "QQ Plot of Total cases", xlab = "County Population")

```

####Sample Model

```{r, results='markup'}

reg_data <- data.frame(x = clean$Population,
                   y = clean$Totcaspopn)

reg_model <- lm(reg_data$y ~ reg_data$x, reg_data)

print(reg_model)

sumstats<-summary(reg_model)

summary(reg_model)

coef(reg_model)

#get list of residuals 
res <- resid(reg_model)

#produce residual vs. fitted plot
plot(fitted(reg_model), res)
plot(fitted(reg_model), res,
     xlab="Fitted Model", 
     ylab="Residuals", 
     main="Residual-Fitted Plot")


#create Q-Q plot for residuals
qqnorm(res,
     xlab="Normal Values", 
     ylab="Residuals", 
     main="Normal Quantile Plot for Residuals")

#add a straight diagonal line to the plot
qqline(res, col="blue") 

```

####Team please note the new variable names above as you create the new model.
#### I have also cleaned out the old codes and only left the code we need for this assignment.

### built model  
**To built model with linear regression.** 
```{r,results=TRUE}
#<<<<<<< julia_montiel
#model <- lm(Total_cases ~ Mental_Health_Provider_Ratio,Counties_Dataset)
#model <- lm(Total_cases ~ Housing..Overcrowding,count_df_clean)
#model
```



```{r, results='markup'}
plot(reg_model)
```

