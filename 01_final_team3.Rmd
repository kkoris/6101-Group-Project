---
title: "01_final"
author: "Team3"
date: "`r Sys.Date()`"
output: 
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r init, include=FALSE}
# some of common options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
library(ezids)
# knitr::opts_chunk$set(warning = F, results = "markup", message = F)
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3) 
# options(scipen=9, digits = 3) 
# ‘scipen’: integer. A penalty to be applied when deciding to print numeric values in fixed or exponential notation.  Positive values bias towards fixed and negative towards scientific notation: fixed notation will be preferred unless it is more than ‘scipen’ digits wider.
# use scipen=999 to prevent scientific notation at all times
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

# HW Assignment - Estimation 
The variables in the dataset are:  
Province,	State, Tests,	Days Since 1st Case,	Total cases,	Deaths,	Population, Hispanic,	Non-Hispanic, Female,	Population Density,Air Quality,Mental Health Provider Ratio,	Smokers,Flu Vaccinated

### Import data

```{r import,results='markup'}
Counties_Dataset <- read.csv("Counties Dataset.csv")
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r, results='markup'}
ncol(Counties_Dataset)
nrow(Counties_Dataset)
```

There are 71 variables and 3012 observations.


Here we are trying to find the NAs in the data frame
```{r, results='markup'}

sum(is.na(Counties_Dataset))

```

There are 4949 NAs in the data frame

Given the number of variables, we are going to clean the data frame by removing some of the variables that we dont believe to be necessary

```{r, results='markup'}

count_df_updated <- subset(Counties_Dataset, select = -c(4, 5))

```

The code below will enable us to remove all NAs from the data set.
```{r, results='markup'}

count_df_clean<-na.omit(count_df_updated)

nrow(count_df_clean)
ncol(count_df_clean)

```

Now we have some decisions to make, after removing all NAs, our data frame is reduced from 3012 observations to 669 observations. This may have a negative impact on our conclusions. 


Testing for normality

```{r, results='markup'}
#install.packages("ggpubr")
library("ggpubr")
ggdensity(count_df_clean$Total_cases, 
          main = "Density plot of Total cases",
          xlab = "Total cases")

ggdensity(count_df_clean$Housing..Overcrowding, main = "Density plot of Housing Overcrwoding",
          xlab = "Total cases")

```
```{r, results='markup'}
#qqplot(count_df_clean$`Housing..Overcrowding`, count_df_clean$Total_cases, main = "QQ Plot of Total cases", xlab = "Average Number of Mentally Unhealth Days")

cor(count_df_clean$Total_cases, count_df_clean$`Housing..Overcrowding`)
reg_data <- data.frame(x = count_df_clean$`Housing..Overcrowding`,
                   y = count_df_clean$Total_cases)

reg_model <- lm(reg_data$y ~ reg_data$x, reg_data)

print(reg_model)

sumstats<-summary(reg_model)

summary(reg_model)

coef(reg_model)

#get list of residuals 
res <- resid(reg_model)

#produce residual vs. fitted plot
plot(fitted(reg_model), res)
plot(fitted(reg_model), res,
     xlab="Fitted Model", 
     ylab="Residuals", 
     main="Residual-Fitted Plot")


#create Q-Q plot for residuals
qqnorm(res,
     xlab="Normal Values", 
     ylab="Residuals", 
     main="Normal Quantile Plot for Residuals")

#add a straight diagonal line to the plot
qqline(res, col="blue") 





```
```{r, results='markup'}
cor(count_df_clean$Total_cases, count_df_clean$`Housing: Overcrowding`)

```

### built model  
**To built model with linear regression.** 
```{r,results=TRUE}
#<<<<<<< julia_montiel
#model <- lm(Total_cases ~ Mental_Health_Provider_Ratio,Counties_Dataset)
model <- lm(Total_cases ~ `Housing..Overcrowding`,count_df_clean)
#model
```

```{r, results='markup'}
plot(model)
```

```{r, results='markup'}
plot(reg_model)
```
Team, I think our data is not normal. We can do several things form here. We can try to employ methods that will fix the normality or we may want to change the model of analysis. I am sending you all a note via email.

```{r, results='markup'}
plot(count_df_clean$Total_cases)
plot(count_df_clean$`% Severe Housing Problems`)
plot(count_df_clean$`Population Density per Square mile of Land (2010)`)

```

# Summary 

Keep code here Summary and Descriptive Statistics to use later. 

```{r eval=FALSE}
summary(Counties_Dataset$`Average Number of Mentally Unhealthy Days`)
str(Counties_Dataset$`Average Number of Mentally Unhealthy Days`)
```

## Descriptive Statistics

Below the descriptive statistics for the number of Mentally Unhealthy Days per county show that on average there are a minimum of 2.5 mentally unhealthy days per county and a maximum of 6.314 mentally unhealthy days per county in 2020. 
#Show ratio of health care providers? Shows outliers in data. 
#Possibly better to show descriptive statistics of # of covid cases per county in 2020 

```{r eval=FALSE}
library(ezids)
xkablesummary( Counties_Dataset[c('Average Number of Mentally Unhealthy Days' , 'Mental Health Provider Ratio')], title = "Counties Dataset Summary" )
#xkablesummary( Counties_Dataset, title = "Counties Dataset Summary" )
```
